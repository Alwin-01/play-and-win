<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Flappy Win</title>

<style>
body {
  margin: 0;
  overflow: hidden;
  font-family: Arial, sans-serif;
  touch-action: manipulation;
}

#game {
  width: 100vw;
  height: 100vh;
  background: linear-gradient(#70c5ce, #cceeff);
  position: relative;
}

/* Bird */
#bird {
  position: absolute;
  left: 120px;
  top: 250px;
  width: 42px;
  height: 32px;
  background: gold;
  border-radius: 50%;
}

#bird::after {
  content: "";
  position: absolute;
  right: -10px;
  top: 12px;
  border-top: 5px solid transparent;
  border-bottom: 5px solid transparent;
  border-left: 10px solid orange;
}

/* Pipes */
.pipe {
  position: absolute;
  width: 70px;
  background: #2ecc71;
}

.top { top: 0; }
.bottom { bottom: 0; }

/* UI */
#score, #round {
  position: absolute;
  top: 20px;
  width: 100%;
  text-align: center;
  font-size: 28px;
  color: white;
  text-shadow: 2px 2px 4px #000;
}

#round { top: 60px; }

#retry {
  display: none;
  position: absolute;
  top: 50%;
  width: 100%;
  text-align: center;
}

#retry button {
  padding: 14px 26px;
  font-size: 20px;
  cursor: pointer;
}

#scam {
  display: none;
  width: 100vw;
  height: 100vh;
  background: #111;
  color: red;
  text-align: center;
  padding-top: 120px;
}
</style>
</head>

<body>

<div id="game">
  <div id="score">Score: 0</div>
  <div id="round">Round: 1 / 3</div>
  <div id="bird"></div>

  <div id="retry">
    <button onclick="restartRound()">Retry</button>
  </div>
</div>

<div id="scam">
  <h1>⚠️ YOU GOT SCAMMED!</h1>
  <p>This game looked real.</p>
  <p>Scams also look real.</p>
  <p><b>Stop. Think. Verify.</b></p>
</div>

<script>
const bird = document.getElementById("bird");
const game = document.getElementById("game");

let birdY, velocity;
let gravity = 0.6;
let gameLoop, pipeTimer;
let pipes = [];
let score = 0;
let round = 1;
let running = false;

/* START GAME */
function startGame() {
  resetState();
  running = true;
  gameLoop = setInterval(updateGame, 20);
  pipeTimer = setInterval(createPipe, 2400);
}

/* RESET ROUND */
function resetState() {
  birdY = 250;
  velocity = 0;
  bird.style.top = birdY + "px";
  pipes.forEach(p => p.top.remove(), p.bottom.remove());
  pipes = [];
  document.getElementById("retry").style.display = "none";
}

/* FLAP */
function flap() {
  if (!running) startGame();
  velocity = -7;
}

document.addEventListener("keydown", e => {
  if (e.code === "Space") flap();
});

document.addEventListener("touchstart", e => {
  e.preventDefault();
  flap();
}, { passive: false });

/* GAME LOOP */
function updateGame() {
  velocity += gravity;
  birdY += velocity;
  bird.style.top = birdY + "px";

  if (birdY < 0 || birdY > window.innerHeight - 40) {
    endRound();
  }

  pipes.forEach(p => {
    p.x -= 3;
    p.top.style.left = p.x + "px";
    p.bottom.style.left = p.x + "px";

    if (
      120 < p.x + 70 &&
      120 + 42 > p.x &&
      (birdY < p.topHeight || birdY + 32 > window.innerHeight - p.bottomHeight)
    ) {
      endRound();
    }
  });
}

/* CREATE PIPE */
function createPipe() {
  const gap = 180;
  const topHeight = Math.random() * 200 + 60;
  const bottomHeight = window.innerHeight - topHeight - gap;

  const top = document.createElement("div");
  top.className = "pipe top";
  top.style.height = topHeight + "px";

  const bottom = document.createElement("div");
  bottom.className = "pipe bottom";
  bottom.style.height = bottomHeight + "px";

  game.appendChild(top);
  game.appendChild(bottom);

  pipes.push({ top, bottom, x: window.innerWidth, topHeight, bottomHeight });
}

/* END ROUND */
function endRound() {
  clearInterval(gameLoop);
  clearInterval(pipeTimer);
  running = false;

  if (round < 3) {
    document.getElementById("retry").style.display = "block";
  } else {
    game.style.display = "none";
    document.getElementById("scam").style.display = "block";
  }
}

/* RETRY */
function restartRound() {
  round++;
  document.getElementById("round").innerText = `Round: ${round} / 3`;
  startGame();
}
</script>

</body>
</html>
