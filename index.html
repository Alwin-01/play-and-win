<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Flappy Win</title>

<style>
body {
  margin: 0;
  overflow: hidden;
  font-family: Arial, sans-serif;
  touch-action: manipulation;
}

#game {
  width: 100vw;
  height: 100vh;
  background: linear-gradient(#70c5ce, #cceeff);
  position: relative;
}

/* Clouds */
.cloud {
  position: absolute;
  width: 140px;
  height: 50px;
  background: white;
  border-radius: 50px;
  opacity: 0.8;
  animation: cloudMove 30s linear infinite;
}

@keyframes cloudMove {
  from { left: -150px; }
  to { left: 110vw; }
}

/* Bird */
#bird {
  position: absolute;
  left: 120px;
  top: 250px;
  width: 42px;
  height: 32px;
  background: url('bird-icon.png') no-repeat center;
  background-size: contain;
}

/* Pipes */
.pipe {
  position: absolute;
  width: 70px;
  background: #2ecc71;
}
.top { top: 0; }
.bottom { bottom: 0; }

/* UI */
#score, #round {
  position: absolute;
  top: 20px;
  width: 100%;
  text-align: center;
  font-size: 28px;
  color: white;
  text-shadow: 2px 2px 4px #000;
}
#round { top: 60px; }

#ready {
  position: absolute;
  top: 45%;
  width: 100%;
  text-align: center;
  font-size: 26px;
  color: white;
}

#retry {
  display: none;
  position: absolute;
  top: 50%;
  width: 100%;
  text-align: center;
}
#retry button {
  font-size: 20px;
  padding: 12px 26px;
  cursor: pointer;
}

#scam {
  display: none;
  width: 100vw;
  height: 100vh;
  background: #111;
  color: red;
  text-align: center;
  padding-top: 120px;
}
</style>
</head>

<body>

<div id="game">
  <div class="cloud" style="top:80px;"></div>
  <div class="cloud" style="top:160px; animation-duration:40s;"></div>

  <div id="score">Score: 0</div>
  <div id="round">Round: 1 / 3</div>
  <div id="ready">Tap or Press SPACE to Fly</div>
  <div id="bird"></div>

  <div id="retry">
    <button onclick="retryRound()">Retry</button>
  </div>
</div>

<div id="scam">
  <h1>⚠️ YOU GOT SCAMMED!</h1>
  <p>This game looked real.</p>
  <p>Scams also look real.</p>
  <p><b>Stop. Think. Verify.</b></p>
</div>

<script>
const bird = document.getElementById("bird");
const game = document.getElementById("game");

let birdY = 250;
let velocity = 0;
let gravity = 0.6;

let running = false;
let score = 0;
let round = 1;
const maxRounds = 3;

let pipes = [];
let gameLoopInterval;
let pipeInterval;

/* START GAME */
function startGame() {
  document.getElementById("ready").style.display = "none";
  document.getElementById("retry").style.display = "none";
  running = true;

  gameLoopInterval = setInterval(gameLoop, 20);
  pipeInterval = setInterval(createPipe, 2600);
}

/* FLAP */
function flap() {
  if (!running) startGame();
  velocity = -7;
}

document.addEventListener("keydown", e => {
  if (e.code === "Space" || e.code === "ArrowUp") flap();
});

document.addEventListener("touchstart", e => {
  e.preventDefault();
  flap();
}, { passive: false });

/* GAME LOOP */
function gameLoop() {
  if (!running) return;

  velocity += gravity;
  birdY += velocity;
  bird.style.top = birdY + "px";

  // Ground or sky hit
  if (birdY < 0 || birdY > window.innerHeight - 32) {
    endRound();
  }

  pipes.forEach(p => {
    p.x -= 3;
    p.top.style.left = p.x + "px";
    p.bottom.style.left = p.x + "px";

    // Collision
    if (
      120 < p.x + 70 &&
      120 + 42 > p.x &&
      (birdY < p.topHeight ||
       birdY + 32 > window.innerHeight - p.bottomHeight)
    ) {
      endRound();
    }
  });
}

/* CREATE PIPE */
function createPipe() {
  const gap = 180;
  const topHeight = Math.random() * 200 + 60;
  const bottomHeight = window.innerHeight - topHeight - gap;

  const top = document.createElement("div");
  const bottom = document.createElement("div");

  top.className = "pipe top";
  bottom.className = "pipe bottom";

  top.style.height = topHeight + "px";
  bottom.style.height = bottomHeight + "px";

  game.appendChild(top);
  game.appendChild(bottom);

  pipes.push({ top, bottom, x: window.innerWidth, topHeight, bottomHeight });
}

/* END ROUND */
function endRound() {
  if (!running) return;
  running = false;

  clearInterval(gameLoopInterval);
  clearInterval(pipeInterval);

  if (round < maxRounds) {
    document.getElementById("retry").style.display = "block";
  } else {
    game.style.display = "none";
    document.getElementById("scam").style.display = "block";
  }
}

/* RETRY */
function retryRound() {
  round++;
  document.getElementById("round").innerText = `Round: ${round} / 3`;

  pipes.forEach(p => {
    p.top.remove();
    p.bottom.remove();
  });
  pipes = [];

  birdY = 250;
  velocity = 0;
  bird.style.top = birdY + "px";

  startGame();
}
</script>

</body>
</html>
